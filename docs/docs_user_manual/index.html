<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.4" />
<title>paroxython.docs_user_manual API documentation</title>
<meta name="description" content="…" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
<a href="https://github.com/laowantong/paroxython"><img style="position: absolute; top: 0; right: 0; border: 0; width: 149px; height: 149px;" src="https://aral.github.com/fork-me-on-github-retina-ribbons/right-cerulean@2x.png" alt="Fork me on GitHub"></a>
<style>.homelink{display:block}.homelink:hover{color:inherit}.homelink img{margin:auto;margin-bottom:.3em}</style>
<link rel="canonical" href="https://laowantong.github.io/paroxython/docs_user_manual/">
<link rel="icon" href="https://laowantong.github.io/paroxython/resources/logo.png">

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {packages:['wordtree']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        var data = google.visualization.arrayToDataTable(
          [ ['node', 'occurrences'], ['type boolean.', 1854], ['        type boolean literal False.', 193], ['        type boolean literal True.', 241], ['        type non_sequence dictionary.', 79], ['        type non_sequence dictionary literal.', 57], ['        type non_sequence dictionary literal empty.', 26], ['        type non_sequence set.', 57], ['        type non_sequence set literal.', 6], ['        type null literal.', 362], ['        type number complex.', 1], ['        type number complex literal.', 1], ['        type number floating_point.', 48], ['        type number floating_point literal.', 292], ['        type number floating_point literal zero.', 22], ['        type number integer.', 198], ['        type number integer literal.', 5119], ['        type number integer literal zero.', 1750], ['        type sequence.', 54], ['        type sequence list.', 531], ['        type sequence list literal.', 629], ['        type sequence list literal empty.', 285], ['        type sequence string.', 445], ['        type sequence string literal.', 1938], ['        type sequence string literal empty.', 128], ['        type sequence string literal formatted.', 62], ['        type sequence tuple.', 7], ['        type sequence tuple literal.', 891], ]
        );
        var options = {
          wordtree: {
            format: 'implicit',
            word: 'type'
          }
        };
        var chart = new google.visualization.WordTree(document.getElementById('wordtree_basic'));
        chart.draw(data, options);
      }
    </script>
    </head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">User manual</h1>
</header>
<section id="section-intro">
<hr>
<h1 id="pipeline-tutorial-getting-recommendations">Pipeline tutorial: getting recommendations</h1>
<p>This tutorial walks you through a series of little “teacher stories” to illustrate how to write the pipeline of commands used by Paroxython's recommendation system.</p>
<p>You run this pipeline on command line with:</p>
<pre><code>paroxython recommend -p 'path/to/your/pipe.py' 'path/to/your/programs/db.json'
</code></pre>
<h2 id="covering-your-bases">Covering your base(s)</h2>
<p>Our simplest pipeline has no command: it just lists the programs of your database, without any filter. This could produce a rather long document, since each source code is printed, along with a list of each and every taxon it implements. Here is the content of your <code>pipe.py</code>:</p>
<pre><code class="python">[]
</code></pre>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The point is that the resulting list is sorted by increasing learning cost. This should give you a rough idea of the pedagogical angle of attack to adopt in your first classes.</p>
</div>
<h2 id="imparting-knowledge">Imparting knowledge</h2>
<h3 id="tracking-the-progress-of-your-course">Tracking the progress of your course</h3>
<p>Suppose that, in your first session, you have introduced your students to the <code>hello_world.py</code>, <code>wheat_and_chessboard.py</code> and <code>euler_005_smallest_multiple.py</code> programs. Not only Paroxython should no longer recommend these programs, but the cost of learning the associated concepts should be considered as zero when they are encountered again in the future.</p>
<pre><code class="python">[
  {
    &quot;operation&quot;: &quot;impart&quot;,
    &quot;data&quot;: [
      &quot;hello_world.py&quot;,
      &quot;wheat_and_chessboard.py&quot;,
      &quot;euler_005_smallest_multiple.py&quot;,
    ],
  },
]
</code></pre>
<h3 id="coming-after-another-course">Coming after another course</h3>
<p>Suppose instead that you intervene after an introductory course given by a colleague. She gives you a folder (named <code>"CS_101"</code>), which contains the programs she has studied with her class. Since you are secretly in love, you assume, somewhat foolishly, that the concepts they implement are mastered by your new students.</p>
<pre><code class="python">[
  {
    &quot;operation&quot;: &quot;impart&quot;,
    &quot;data&quot;: &quot;find CS_101 -path '*.py'&quot;,
  },
]
</code></pre>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As you can see, rather than maintaining a <strong>list</strong> of programs or concepts in the <code>"data"</code> field, you may provide a <strong>string</strong>. Paroxython will interpret it as a shell command, and expect it to print on <code>stdout</code> the required list of items (programs or taxa), one per line.</p>
</div>
<h2 id="blacklisting-programs">Blacklisting programs</h2>
<p>You want to filter out all programs reserved for an exam, or too complex, or not pedagogically interesting enough, or that could get you kicked out of your college, etc.</p>
<pre><code class="python">[
  {
    &quot;operation&quot;: &quot;exclude&quot;,
    &quot;data&quot;: [
      &quot;fizzbuzz.py&quot;,
      &quot;alpha_go.py&quot;,
      &quot;hello_world_of_pain.py&quot;,
      &quot;gob_s_program.py&quot;,
    ],
  },
]
</code></pre>
<h2 id="concepts-to-be-introduced-later-or-never">Concepts to be introduced later (or never)</h2>
<p>For the time being, you don't want to be recommended any program requiring the concepts of recursivity (<code>subroutine/recursive</code>), dictionary (<code>type/non_sequence/dictionary</code>) or set (<code>type/non_sequence/set</code>).</p>
<pre><code class="python">[
  {
    &quot;operation&quot;: &quot;exclude&quot;,
    &quot;data&quot;: [
      &quot;subroutine/recursive&quot;,
      &quot;type/non_sequence&quot;,
    ],
  },
]
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Paroxython relies on the last three characters of a <code>"data"</code> item to decide whether it is a
Python program (ending with <code>".py"</code>) or a taxon (like here).</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Since the two latter taxa share a common prefix and Python doesn't provide other non-sequence
type, it is enough to exclude all taxa starting with <code>type/non_sequence</code>.</p>
</div>
<h2 id="concepts-to-be-introduced-now">Concepts to be introduced now</h2>
<p>Your next class will be devoted to conditional constructs. Thus, you need to go through programs featuring taxa prefixed by <code>flow/conditional</code> or even, why not, some conditional expressions (<code>operator/ternary</code>). The suggested programs do not necessarily have to implement both concepts at the same time, but at least one. Any other program will be rejected.</p>
<pre><code class="python">[
  {
    &quot;operation&quot;: &quot;include&quot;,
    &quot;data&quot;: [
      &quot;flow/conditional&quot;,
      &quot;operator/ternary&quot;,
    ],
  },
]
</code></pre>
<h2 id="preparing-an-assignment">Preparing an assignment</h2>
<p>Basically, you provide Paroxython with a list of programs already studied in class, and it suggests new programs that implement only old concepts. This requires the exclusion of all programs featuring at least one concept that has not been seen in any of the programs already seen.</p>
<p>It may sound a little complicated, because it is. But don't panic. Remember that Paroxython always orders its recommendations by increasing cost. Thus, all you have to do is ask it to list the programs that have not been introduced yet. The programs you want to choose among will appear at the top of the results, under the zero-learning cost section. Moreover, inside each section, they will be sorted by increasing size (<a href="https://en.wikipedia.org/wiki/Source_lines_of_code"><abbr title="Source Lines Of Code">SLOC</abbr></a>), which can be a reasonable proxy for their difficulty.</p>
<p>But in the end, you, the teacher, are the judge. Paroxython is not going to set up a test for you, let alone grade the answers. It is just here to remind you of some possibilities you might not have thought of at the right time, and to give you some confidence that the exercises require no concept you have not pre-introduced in class, which later on might save you some awkward conversations with your dear students.</p>
<p>Since this is the last filter in our tutorial, let's summarize what we've seen by chaining several commands together:</p>
<ol>
<li><strong>Impart</strong> the previous knowledge by extracting all the programs listed in the <code>"timeline.txt"</code> file that you update after each session. You can adapt the script <a href="https://github.com/laowantong/paroxython/blob/master/helpers/parse_syllabus.py"><code>parse_syllabus.py</code></a> to your own needs. If you wish, you can use the <code>base_path</code> variable, which represents the parent of the directory containing the programs of your personal database.</li>
<li><strong>Exclude</strong> some irrelevant programs.</li>
<li><strong>Include</strong> the concepts that you want to test during your exam.</li>
</ol>
<pre><code class="python">[
  {
    &quot;operation&quot;: &quot;impart&quot;,
    &quot;data&quot;: &quot;python helpers/parse_syllabus.py {base_path}/timeline.txt&quot;,
  },
  {
    &quot;operation&quot;: &quot;exclude&quot;,
    &quot;data&quot;: [
      &quot;foo.py&quot;,
      &quot;bar.py&quot;,
      # &quot;buzz.py&quot;,
    ],
  },
  {
    &quot;operation&quot;: &quot;include&quot;,
    &quot;data&quot;: [
      &quot;pattern/elements/accumulate&quot;,
      &quot;topic/game&quot;,
      &quot;type/sequence/list&quot;,
    ],
  },
]
</code></pre>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This command pipeline is <em>not</em> a <abbr title="JavaScript Object Notation">JSON</abbr> file, but a Python program, or more restrictively a Python <strong>expression</strong>. As such, it offers several amenities you surely know and love: comments, trailing commas, r-strings, etc.</p>
</div>
<p>This is the end of our pipeline tutorial. If you dare, <a href="#deep-in-the-pipeline">read on</a> for more advanced features (regular expressions, span algebra, semantic triples, negations).
<br></p>
<hr>
<h1 id="tag-databases">Tag databases</h1>
<p>Depending on the extension of <code>DB_NAME</code> (either <code>".json"</code> or <code>".sqlite"</code>), the command:</p>
<pre><code>paroxython collect -o DB_NAME DIRECTORY
</code></pre>
<p>&hellip; will create two kinds of databases, each with their own purpose.</p>
<h2 id="the-json-tag-database">The <abbr title="JavaScript Object Notation">JSON</abbr> tag database</h2>
<p>It is this type of so-called NoSQL database that Paroxython draws upon to recommend programs. Its schema is:</p>
<pre><code class="json">{
    &quot;programs&quot;: {
        &quot;program_1.py&quot; : {
            &quot;timestamp&quot;: &quot;1970-01-01&quot;,
            &quot;source&quot;: &quot;print('hello')\nprint('world')\n&quot;,
            &quot;labels&quot;: {
                &quot;label_1&quot;: [[span_start_1, span_end_1], ...],
                ...
            },
            &quot;taxa: {
                &quot;taxon_1&quot;: [[span_start_1, span_end_1], ...],
                ...
            }
        },
        ...
    }
    &quot;labels&quot;: {
        &quot;label_1&quot;: [&quot;program_1.py&quot;, &quot;program_2.py&quot;, ...],
        ...
    },
    &quot;taxa&quot;: {
        &quot;taxon_1&quot;: [&quot;program_1.py&quot;, &quot;program_2.py&quot;, ...],
        ...
    },
    &quot;importations&quot;: {
        &quot;program_1.py&quot;: [&quot;program_2.py&quot;, &quot;program_3.py&quot;, ...],
        ...
    },
    &quot;exportations&quot;: {
        &quot;program_1.py&quot;: [],
        &quot;program_2.py&quot;: [&quot;program_1.py&quot;, ...],
        ...
    }
}
</code></pre>
<p>As an example, take a look on the <a href="https://github.com/laowantong/paroxython/blob/master/examples/simple/programs_db.json"><abbr title="JavaScript Object Notation">JSON</abbr> tag database</a> of the Python Wiki's <a href="https://github.com/laowantong/paroxython/blob/master/examples/simple/programs">21 simple programs</a>.</p>
<h2 id="the-sqlite-tag-database">The SQLite tag database</h2>
<p>This kind of database is fundamentally agnostic, but lends itself quite well to statistics. Its schema is:</p>
<pre><code class="sql">CREATE TABLE program (
    program TEXT PRIMARY KEY,
    timestamp TEXT,
    source TEXT
);
CREATE TABLE label (
    -- use rowid as primary key
    label TEXT,
    label_prefix TEXT,
    label_suffix TEXT,
    span TEXT,
    span_start INTEGER,
    span_end INTEGER,
    program TEXT,
    FOREIGN KEY (program) REFERENCES program (program)
);
CREATE TABLE taxon (
    -- use rowid as primary key
    taxon TEXT,
    span TEXT,
    span_start INTEGER,
    span_end INTEGER,
    program TEXT,
    FOREIGN KEY (program) REFERENCES program (program)
);
</code></pre>
<p>Having a relational version of the tag database means that it can be queried with <abbr title="Structured Query Language">SQL</abbr>. Here is an example which returns the 20 most frequent taxa:</p>
<pre><code class="sql">SELECT taxon, count(*) AS occurrences
FROM taxon
GROUP BY taxon
ORDER BY occurrences DESC
LIMIT 20
</code></pre>
<p>More complex, a query comparing the number of occurrences of the loops <code>for</code> and <code>while</code>:</p>
<pre><code class="sql">SELECT (CASE SUBSTR(taxon, 11, 3) -- extract either &quot;for&quot; or &quot;whi&quot;
            WHEN &quot;for&quot; THEN &quot;for&quot; -- and replace it either by... itself
            ELSE &quot;while&quot; -- or by the complete name of the loop
        END) AS loop,
       COUNT(*) AS occurrences
FROM taxon
WHERE taxon LIKE &quot;flow/loop/for%&quot;
   OR taxon LIKE &quot;flow/loop/while%&quot;
GROUP BY SUBSTR(taxon, 0, 14) -- cut the taxon three characters after &quot;flow/loop/&quot;
</code></pre>
<p>In theory, the relational database can also be used to select programs according to certain criteria:</p>
<pre><code class="sql">SELECT
    taxon,
    program,
    group_concat(span, &quot;, &quot;) AS spans,
    source
FROM program
JOIN taxon USING (program)
WHERE taxon GLOB &quot;type/non_sequence/dictionary/*&quot;
GROUP BY taxon, program
</code></pre>
<p>On the provided <a href="https://github.com/laowantong/paroxython/blob/master/examples/simple/programs">simple programs</a>, the execution yields:</p>
<p><img alt="" src="../resources/sql_query_example.png"></p>
<p>Note however that the same list of programs (with learning costs!) could have been obtained by feeding the function <code><a title="paroxython.recommend_programs.Recommendations.run_pipeline" href="../recommend_programs.html#paroxython.recommend_programs.Recommendations.run_pipeline">Recommendations.run_pipeline()</a></code> with an elementary command:</p>
<pre><code class="python">    {
        &quot;operation&quot;: &quot;include&quot;,
        &quot;data&quot;: [&quot;type/non_sequence/dictionary/&quot;]
    }
</code></pre>
<p>So, although <abbr title="Structured Query Language">SQL</abbr> should be familiar to almost everyone in our target audience, and might “make complex things possible”, as far as filtering is concerned, our minimalistic schema arguably does not ”make simple things simple” (to paraphrase Alan Kay). Some denormalization should ease the process, but so far we have prioritized the development of the pipeline system.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently, the relational database is better suited for making statistics than recommendations.</p>
</div>
<hr>
<h1 id="taxonomy">Taxonomy</h1>
<h2 id="structure">Structure</h2>
<p>In Paroxython, the default taxonomy is a <a href="https://en.wikipedia.org/wiki/Tree_(graph_theory)#Forest">forest</a>: a dozen of separate trees with <code>flow</code>, <code>operator</code>, <code>metadata</code>, <code>type</code>, etc. as their roots. We call <strong>taxon</strong><sup id="fnref:taxon"><a class="footnote-ref" href="#fn:taxon" rel="footnote">1</a></sup> a path from a root node to a leaf node. Thus:</p>
<pre><code class="plain">type/number/integer/literal
</code></pre>
<p>&hellip; describes this kind of literal which is a kind of integer which is a kind of number which is a kind of type (as an example, think of the answer to the ultimate question of life, the universe, and everything). Such a nesting makes the taxa especially relevant for the teacher, in that it offers a first structuration of an otherwise scattered knowledge.</p>
<p>An instance of tree rooted in <code>type</code> is shown below:</p>
<div id="wordtree_basic" style="width: 100%; height: 500px;"></div>
<p>This comes<sup id="fnref:tree_sql"><a class="footnote-ref" href="#fn:tree_sql" rel="footnote">2</a></sup> straight from the tagging of the public repository <a href="https://github.com/TheAlgorithms/Python">The Algorithms - Python</a>. The size of a node is relative to the number of times the corresponding taxon's <em>prefix</em> appears in the programs. Hover over the nodes to see these numbers, or click them to navigate the tree.</p>
<h2 id="mapping-the-labels-onto-taxa">Mapping the labels onto taxa</h2>
<p>Paroxython does not directly produce these taxa. Remember, a program is first tagged with labels (as specified in <a href="https://github.com/laowantong/paroxython/blob/master/paroxython/resources/spec.md"><code>spec.md</code></a>), which are then translated into taxa by a purely morphological operation (search and replace), without any more reference to the original source code.</p>
<h3 id="1-1-and-n-1-mappings">1-1 and N-1 mappings</h3>
<p>Suppose a program has been tagged with the labels:</p>
<ul>
<li><code>literal:True</code> (the constant <code>True</code>).</li>
<li><code>literal:False</code> (the constant <code>False</code>).</li>
<li><code>external_free_call:bool</code> (a call to the built-in function <code>bool()</code>).</li>
<li><code>node:Compare</code> (a comparison<sup id="fnref:compare"><a class="footnote-ref" href="#fn:compare" rel="footnote">3</a></sup> expression).</li>
</ul>
<p>The following conversion table (extracted from <a href="https://github.com/laowantong/paroxython/blob/master/paroxython/resources/taxonomy.tsv"><code>taxonomy.tsv</code></a>) will then give the taxa seen above in the subtree <code>type/boolean</code>:</p>
<table>
<thead>
<tr>
<th align="left">Taxa (replacement patterns)</th>
<th align="left">Labels (search patterns)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>type/boolean/literal/True</code></td>
<td align="left"><code>literal:True</code></td>
</tr>
<tr>
<td align="left"><code>type/boolean/literal/False</code></td>
<td align="left"><code>literal:False</code></td>
</tr>
<tr>
<td align="left"><code>type/boolean</code></td>
<td align="left"><code>external_free_call:bool</code></td>
</tr>
<tr>
<td align="left"><code>type/boolean</code></td>
<td align="left"><code>node:Compare</code></td>
</tr>
</tbody>
</table>
<p>Note that, somewhat counterintuitively, the conversion goes from right to left. Each line consists of a taxon tab-separated from a label. It is interpreted as “when a program features this label, create that taxon with the same spanning lines”.</p>
<ul>
<li>The first two rows are 1-1 mappings: each one translates one label into one taxon.</li>
<li>The last two rows constitute an N-1 mapping: they translate two distinct labels into a single taxon.</li>
</ul>
<p>The previous table extract represents the simplest case, where both taxon and label patterns are literal (they don't contain any metacharacter, more on that below).</p>
<h3 id="1-0-mapping">1-0 mapping</h3>
<p>At first glance, some of the labels generated during the first step seem redundant. For instance, <code>"binary_operator:Add"</code> and <code>"addition_operator"</code>. In fact, the former was used to calculate the latter. In <a href="https://github.com/laowantong/paroxython/blob/master/paroxython/resources/spec.md"><code>spec.md</code></a>, the definition of <code>"addition_operator"</code> is introduced by these words: “An addition operator is a binary operator <code>Add</code> which has not be classified as a concatenation operator”.</p>
<p>This is a good example of label for internal use only. In the conversion step, it will be simply ignored (i.e., it has no entry in the taxonomy).</p>
<h3 id="1-n-mapping">1-N mapping</h3>
<p>When a source code is, say, 8 lines long, it is tagged with the label <code>"whole_span:8"</code>. This is an example of a label which produces two taxa: <code>"metadata/program"</code> and <code>"metadata/sloc/8"</code>. Both span the whole program and, although it is not obvious, both have their uses.</p>
<p>The first one is common to all programs, and provides an invariable access key to an all-encompassing span. In a command pipeline, it can be used to <a href="#expressing-the-absence-of-a-taxon">express the absence of a taxon</a>.</p>
<p>The second one has a variable part, and can be used to filter programs by <a href="https://en.wikipedia.org/wiki/Source_lines_of_code">size</a> (for example, in <code><a title="paroxython.recommend_programs" href="../recommend_programs.html">paroxython.recommend_programs</a></code>, the pattern <code>"metadata/sloc/[1-5]"</code> will be used to filter out the programs that have more than 5 lines).</p>
<p>This conversions are triggered by the following rows in the default taxonomy:</p>
<table>
<thead>
<tr>
<th align="left">Taxa (replacement patterns)</th>
<th align="left">Labels (search patterns)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>metadata/program</code></td>
<td align="left"><code>whole_span:.+</code></td>
</tr>
<tr>
<td align="left"><code>metadata/sloc/\1</code></td>
<td align="left"><code>whole_span:(.+)</code></td>
</tr>
</tbody>
</table>
<p>As you may have guessed, the right colum can contain <a href="https://en.wikipedia.org/wiki/Regular_expression">regular expressions</a>. On the first row, the sequence of <em>metacharacters</em> <code>".+"</code> means: “eat all the characters up to the end of the line.” On the second row, the added parentheses also <em>captures</em> these characters: they are restituted in the replacement pattern by <code>"\1"</code>, which denotes a <a href="https://docs.python.org/3/library/re.html#re.sub"><em>backreference</em></a> to the first captured group.</p>
<!-- Why the default taxonomy is no silver bullet, and what you can do about it
Although these rules make sense, they raise several questions.
Pedagogically speaking, should explicit and implicit booleans be given the same weight? After all, it is quite possible to talk about conditionals (which everyone has experience with in the real world) before introducing formally the boolean type (which firmly belongs to the abstract realm of logic). If your students are young adults, you may start with booleans. If they are kids, the conditionals could be a better choice: in that case, you can avoid the noise by removing from your personal taxonomy the line.
We said that the occurrence of a boolean operator implies that of a boolean value, but in Python this is not necessarily the case. For instance, in:
wzxhzdk:16
... there is indeed a boolean operator, but a boolean value is nowhere to be seen (<code>name</code> is assigned to the string entered by the user, or `"Anonymous Coward"` in case of an empty string). We could easily extend <code>spec.md</code> to detect some of these situations, but not all of them, if only because Paroxython doesn't support [type inference](https://en.wikipedia.org/wiki/Type_inference#Technical_description)[^no_inference].
[^no_inference]:
For instance, replacing `"Anonymous Coward"` with a <s>constant</s> variable <code>DEFAULT\_NAME</code> previously assigned to `"Anonymous Coward"` would be enough to defeat it.
This is a typical scenario where you, as a dedicated teacher, should annotate your code with a manual hint, asking Paroxython to delete the label it has wrongly generated:
wzxhzdk:17
But this issue raises another one. Since the offending line of code is in fact functionally equivalent to:
wzxhzdk:18
... it calls into question another part of the taxonomy:
wzxhzdk:19
!!! note "Note"
`short_circuit:And` is a **label** (of the kind defined, but not necessarily included in [spec.md](https://github.com/laowantong/paroxython/blob/master/paroxython/resources/spec.md)), but not a taxon. It will be later converted into one or more taxa (according to the mapping of [taxonomy.tsv](https://github.com/laowantong/paroxython/blob/master/paroxython/resources/taxonomy.tsv)).
To delete a label, prefix it with a minus symbol. For instance, the following hint requalifies an addition into a string concatenation:
wzxhzdk:20
If a label should span over several lines, it is hinted on the first line with a <code>...</code> suffix (meaning “to be continued”), and on the last line with a <code>...</code> prefix (meaning “continuing”). In the following example, a label <code>super\_loop</code> is manually substituted to the calculated label `loop:for`:
wzxhzdk:21
Of course, the opening and the closing of a spanning label must be correctly balanced.
Some tolerances exist for the syntax:
- `+` can be omitted.
- <code>...</code> (three dots) can be written `…` (HORIZONTAL ELLIPSIS, U+2026).
- `# paroxython:` is neither space- nor case-sensitive.
----
# Deep in the pipeline
This part describes in some details how the recommendation system works. It assumes you've already read the [tutorial on recommendations](#pipeline-tutorial-getting-recommendations). First of all, let us recall the example of pipeline we gave at the end.
wzxhzdk:22
## Regular expression patterns
The first thing to clarify is that the strings which constitute the <code>data</code> lists are not simple names, but “descriptions” of names. These descriptions, or **patterns**, are written in the language of regular expressions, and more precisely in the dialect implemented by the third-party module [regex](https://pypi.org/project/regex/)[^regex-credits].
[^regex-credits]:
This module appears to be here to stay, since it is proeminently featured in the documentation of the more mundane standard library [re](https://docs.python.org/3/library/re.html).
Thanks and kudos to the author, Matthew Barnett: without his awesome work, many parts of our code would have been much tougher to write, and much slower to execute.
!!! tip "Tip"
If you don't know how to write regular expressions, the good news is that you don't have to worry. Unless they contain certain special characters, they are self-descriptive. That means, for instance, that the string `"type/sequence/list"` happens to be a regular expression which precisely describes (or ”matches”) the string `"type/sequence/list"`. This is the case for all strings that are only made up of so-called _literal_ characters.
As a matter of fact, all the characters that can appear in a taxon are literal. We advise you to avoid non-literal characters in your program names as well. What are they? Essentially: `.^$*+?{}\[]`. Depending on your operating system, some are already illegal in filenames anyway. To tell the truth, the first one (the dot) is an integral part of most filenames, as an extension separator. However, it turns out that it basically means “any character”, which of course includes the dot itself. So, the regular expression `"hello_world.py"` matches the filename `"hello_world.py"`, and the fact that it matches `"hello_world/py"` and `"hello_worldapy"` shouldn't be a real problem. In any case, you can always prefix (or _escape_) a non-literal character with a backslash `"\"` to make it literal (here, `"hello_world\.py"`): that's all you'll need to know about regular expressions.
The second thing to clarify is that a given pattern will match any string **starting** with it. Thus, `"type/sequence/list"` will match not only `"type/sequence/list"`, but `"type/sequence/list/empty"` and `"type/sequence/list/supercalifragilisticexpialidocious"` too. The same applies to program names. For example, in our personal database, all programs from [Project Euler](https://projecteuler.net) start with `"euler_"`. The pattern `"euler_"` will then match all of them.
In terms of regular expressions, it means that, under the hood, Paroxython invokes [`match()` instead of <code>search()</code>](https://docs.python.org/3/library/re.html#search-vs-match). In the rare cases where you want to restrict the whole matching to the pattern itself, simply suffix it with a dollar sign, i.e., `"type/sequence/list$"`.
## Execution of a pipeline
A pipeline is a set (or list, but the order is not important) of commands which apply sequentially to a database of program tags. It returns:
- a list of recommended programs;
- an estimation of the learning cost of each concept (i.e., taxon) they implement.
The set of commands constitutes a pipeline that evolves both:
- a selection of programs (initially all those in the tag database);
- a body of imparted knowledge (initially empty).
!!! note "Note"
During this process, the program selection can never increase, and the imparted knowledge can never decrease.
A command consists of:
- an operation among `"include"`, `"exclude"`, `"impart"` and `"hide"`, optionally suffixed by the quantifier (`" all"`);
- the data to which it applies. This data is (or can be interpreted to produce) a list of criteria, each criterion being:
- either a program pattern,
- or a taxon pattern,
- or a relationship between two taxon patterns (more on this in the [Semantic triples](#semantic-triples) section).
Combining the operation with a criterion is done in four stages:
1. An auxiliary set of programs is calculated.
2. The set of recommended programs (the **selection**) is updated.
3. A new set of taxa may be “learned”, i.e., added to the body of imparted knowledge.
4. The set of taxa and programs to hide in the final report may be updated.
Note that each stage depends on both the operation and the nature of the criterion to which it applies. Let us detail every possible case:
### `"include"` command
Its purpose is to keep only those selected programs that satisfy at least one given criterion.
1. The auxiliary set contains any program such that:
- either its name matches the given pattern,
- or its source code:
- either features at least one taxon matching the given pattern,
- or satisfies the given relationship.
2. The selection is then restricted to its **intersection** with the auxiliary set.
3. The imparted knowledge is unchanged.
**`"include all"` variant**
Its purpose is to keep only those selected programs that satisfy all given criteria.
wzxhzdk:23
... is equivalent to:
wzxhzdk:24
### `"exclude"` command
Its purpose is to filter out of the selection the programs which satisfy at least one given criterion.
1. The same auxiliary set of programs as above (`"include"`) is calculated, but further extended to the programs which import them
(either directly or indirectly). Indeed, when the teacher wants to exclude a certain program, any program that requires it should be excluded as well.
2. The selection is then restricted to its **difference** with the auxiliary set.
3. The imparted knowledge is unchanged.
**`"exclude all"` variant**
Unlike `"include all"`, this variant actually expands the semantics of the system.
wzxhzdk:25
... excludes the programs satisfying **all** the criteria. This cannot be transformed into a sequence of `"exclude"` commands, which would exclude the programs satisfying **any** of the criteria.
### `"impart"` command
Its main purpose is to track the acquisition of new knowledge. However, if this knowledge is provided by a given set of programs, there is no more need to keep them in the selection of recommended programs.
1. The auxiliary set contains all programs whose name matches at least one of the given patterns (relationships are not supported), plus those which import (either directly or indirectly) at least one of them. In other words, it is the same as above (`"exclude"`), but only in the case where the criterion is a program pattern. In all other cases, this auxiliary set will be empty.
2. The selection is then restricted to its **difference** with the auxiliary set (same as above for `"exclude"`).
3. There are three cases:
1. If the criterion is a program pattern, all the taxa featured in a program whose name matches this pattern are added to the body of imparted knowledge.
2. If the criterion is a taxon pattern, all the taxa matching this pattern are added to the body of imparted knowledge.
3. Otherwise, the body of imparted knowledge is unchanged.
The `"impart all"` variant is not supported, and treated as `"impart"`.
### `"hide"` command
This is the simplest command of all. It merely accumulates the programs or the taxa matching the given patterns (relationships are not supported), without other effect on the filter. In the final stage, the accumulated programs or taxa will be filtered out of report.
**Notes.**
- Excluding a program is equivalent to hiding it _plus_ every program importing it.
- The learning costs are not affected whatsoever by the hiding of a taxon: its individual cost continues to contribute towards the total cost of a program.
The `"hide all"` variant is not supported, and treated as `"hide"`.
## Semantic triples
### Span algebra
Being given a program \(p\) of \(n\) lines, a couple \((i_1, i_2) \) of line numbers such that \(1 \leq i_1 \leq i_2 \leq n\) represents a **span** of \(p\). When Paroxython finds a taxon \(t\) in \(p\), it doesn't just say whether \(p\) features \(t\) or not: it returns the list of spans where \(t\) occurs.
!!! note "Note"
Any taxon starting with `"metadata/"` is considered by convention to span the entire program.
It is sometimes interesting to know how the spans of two taxa of the same program are located relatively to each other.
- For instance, a <code>print()</code> statement whose span is inside the span of a function indicates that this function has a side-effect.
- A less trivial application stems from the fact that our taxonomy is multi-dimensional: each algorithmic feature can be associated with several taxa at the same time, characterizing it it along several dimensions. For instance, the taxa `flow/loop/for` and `flow/loop/while` describe the category of a loop; whereas the taxa `flow/loop/exit/early` and `flow/loop/exit/late` describe its exit behavior. These dimensions are independent and, although it is entirely possible to do so, our default taxonomy does not list the results of the cross-product (i.e., `flow/loop/for/exit/early`, `flow/loop/for/exit/late`, `flow/loop/while/exit/early` and `flow/loop/while/exit/late`). Querying an hypothetical taxon `flow/loop/for/exit/early` (or `flow/loop/exit/early/for`, by the way) comes down to querying the taxa `flow/loop/for` spanning the same lines as `flow/loop/exit/early`.
To express a relation \(\mathfrak{R}\) between the spans of two taxa, we start from the algebra devised in 1983 by James F. Allen in his seminal paper ([PDF](http://cse.unl.edu/~choueiry/Documents/Allen-CACM1983.pdf)) about temporal intervals[^Allen1983]. The so-called Allen's interval algebra defines 13 basic operators which capture all possible relations between two intervals \(X=(x_1, x_2)\) and \(Y=(y_1, y_2)\). The table below uses his terminology:
[^Allen1983]:
Allen, James F. (26 Nov. 1983). _Maintaining knowledge about temporal intervals_. Communications of the ACM. 26 (11): 832–843. doi:10.1145/182.358434
| Examples | \(\mathfrak{R}\) on endpoints | \(X \mathbin{\mathfrak{R}} Y\)
| \(Y \mathbin{\mathfrak{R}} X\)
| Keys |
|:----:|:----:|:----:|:----:|:----:|
| <code>....XXXXX........</code> &nbsp; | | |
| <code>....YYYYY........</code> &nbsp; | \(x_1 = y_1 \leq x_2 = y_2\)
&nbsp; | \(X\) <code>equals</code> \(Y\)
&nbsp; | \(Y\) <code>equals</code> \(X\)
&nbsp; | `x=y≤x=y`
| <code>....YYYYYYYYY....</code> &nbsp; | \(x_1 = y_1 \leq x_2 \leq y_2\)
&nbsp; | \(X\) <code>starts</code> \(Y\)
&nbsp; | \(Y\) <code>started by</code> \(X\)
&nbsp; | `x=y≤x≤y`
| <code>..YYYYYYYYY......</code> &nbsp; | \(y_1 \leq x_1 \leq x_2 \leq y_2\) &nbsp; | \(X\) <code>during</code> \(Y\)
&nbsp; | \(Y\) <code>contains</code> \(X\)
&nbsp; | `y≤x≤x≤y`
| <code>.YYYYYYYY........</code> &nbsp; | \(y_1 \leq x_1 \leq x_2 = y_2\)
&nbsp; | \(X\) <code>finishes</code> \(Y\)
&nbsp; | \(Y\) <code>finished by</code> \(X\)
&nbsp; | `y≤x≤x=y`
| `....|...|..YYYYY.` &nbsp; | \(x_1 \leq x_2 \leq y_1 \leq y_2\) &nbsp; | \(X\) <code>before</code> \(Y\)
&nbsp; | \(Y\) <code>after</code> \(X\)
&nbsp; | `x≤x≤y≤y`
| `....|...|YYYYY...` &nbsp; | \(x_1 \leq x_2 = y_1 \leq y_2\)
&nbsp; | \(X\) <code>meets</code> \(Y\)
&nbsp; | \(Y\) <code>met by</code> \(X\)
&nbsp; | `x≤x=y≤y`
| `....|..YYYYY.....` &nbsp; | \(x_1 \leq y_1 \leq x_2 \leq y_2\) &nbsp; | \(X\) <code>overlaps</code> \(Y\)
&nbsp; | \(Y\) <code>overlapped by</code> \(X\) &nbsp; | `x≤y≤x≤y`
These well-known operators apply quite nicely to our spans, with the following adjustments:
**Synonyms.** The 13 operator names, whose some don't make much sense in a non-temporal context, are extended
with a number of synonyms, such as `"inside"` for `"during"`, and `"equal"` or `"is"` for
`"equals"`. The current list can be found
[here](https://github.com/laowantong/paroxython/blob/master/paroxython/compare_spans.py#L195).
**Non-strict inequalities.** In the above table, contrary to the convention on time intervals, we
consider the inequalities to be large. In a program, most features span exactly one (logical) line
(i.e., \(x_1=x_2\)): this is simply not possible with the original relations on endpoints. Besides,
when we look for a function which
**contains** a loop, we are generally not interested in whether
the loop **finishes** on the last line. Blind adherence to strictness convention would force us to
express our query as a disjunction of these two relations for the following program to be selected:
wzxhzdk:26
**Strict inequalities.** In addition to the existing relations, all combinations of strict and non-strict
conditions are generated, for instance \(x_1 < x_2 < y_1 \leq y_2\). That adds up to 162 in total[^predicate_count].
[^predicate_count]:
\(162 = 6 \times 27\), where \(6\) is the number of distinct permutations of the quadruple \((x, x, y, y)\), and \(27=3^3\) the number of elements of the triple auto-product of \(3\) symbols (`=`, `≤` and `<`).
**Keys.** As we use many more operators than Allen, giving an English name to every single one is not an option. Paroxython actually identifies them by a unique key (see the last column of the table above) calculated like this:
1. Start from the chain of equalities and inequalities that defines the relations between the two spans' endpoints: \(y_1 < x_1 = y_2 \leq x_2\).
2. Drop the indices (since, for a given \(x\) or \(y\), indice \(1\) always comes before indice \(2\), no information is lost): \(y < x = y \leq x\).
3. Rewrite the formula using only the five characters `"="`, `"<"`, `"≤"`, `"x"` and `"y"`: `y<x=y≤x`.
**Key normalization.**
Paroxython tries (cf. <code><a title="paroxython.normalize_predicate.normalize_predicate" href="../normalize_predicate.html#paroxython.normalize_predicate.normalize_predicate">normalize\_predicate()</a></code>) to be tolerant with the user input. The verb `"is"` is ignored, except when it constitutes the whole string (thus, `"is after"` comes down to `"after"`). When an operator is not an Allen's name or a predefined synonym, the following normalization process is applied:
1. Replace any `<=` by `≤`.
2. Replace any `==` by `=`.
3. Strip all characters distinct from `"="`, `"<"`, `"≤"`, `"x"` and `"y"`.
4. If the string is `"x=y"` or `"y=x"`, replace it by `"x=y≤x=y"`.
2. If the string contains only one <code>x</code> (resp. <code>y</code>), expand it into `x≤x` (resp. `y≤y`).
This allows the user to be understood when entering formulas like
`x == y`, `x <= y` or `y1 < x1 == x2 <= y2`.
### Positive semantic triples
A pipeline command can apply not only to patterns of programs and taxa, but also to relationships between the spans of two taxon patterns. Being given an operator \(\mathfrak{R}\) and two taxon patterns \(t_1\) and \(t_2\), the statement \(t_1 \mathbin{\mathfrak{R}} t_2\) will be codified in the form of the _subject–predicate–object_ expression \((t_1, \mathfrak{R}, t_2)\), which can be entered as a mere Python tuple <code>(t1, R, t2)</code>.
The simplest semantic triple is:
wzxhzdk:27
It matches all programs where the span of the taxon `"metadata/program"` includes the span of a given <code>taxon\_pattern</code>. Since, by definition, every program features one taxon `"metadata/program"`, whose span encompasses the whole program, this is strictly equivalent to:
wzxhzdk:28
And now for something completely different: the following pipeline command will only keep programs featuring a conditional inside a loop **or** (inclusive) ended by a <code>return</code> statement (the function <code>first\_missing\_non\_negative()</code> given above satisfies these two criteria).
wzxhzdk:29
It is currently not possible to chain several operators with shared operands, for example to keep only the programs that feature a conditional inside a loop **and** ended by a <code>return</code> statement: the quintuple `("flow/loop", "contains", "flow/conditional", "finished by", "subroutine/return")` would raise an error. As it stands, the best we can do is to chain the commands themselves:
wzxhzdk:30
This keeps only the programs that feature a conditional inside a loop **and** a conditional ended by a <code>return</code> statement **and** a <code>return</code> statement inside a loop. The result is a subset of the previous one, but may still include programs where the two loops, conditionals or <code>return</code> statements are distinct.
### Negative semantic triples
It is possible to negate the predicate of a semantic triple, either by prefixing it by an exclamation mark (e.g., `"!x≤y≤y≤x"`, or `"!contains"`), or by adding the word _not_ (_e.g_, `"not x≤y≤y≤x"`, `"not contains"`,
or `"contains not"`), whether it's grammatically correct or not.
#### Expressing the absence of a taxon
Here again, the simplest _negated_ semantic triple is:
wzxhzdk:31
On a set of **independent programs** (i.e., not importing each other), there is a strict equivalence between:
wzxhzdk:32
and:
wzxhzdk:33
And, conversely, between:
wzxhzdk:34
and:
wzxhzdk:35
This property may be used to select the programs that include any subset of a given set of taxa. This can be done in a systematic way by converting[^to_cnf] the corresponding logical formula in [conjunctive normal form](https://en.wikipedia.org/wiki/Conjunctive_normal_form), and transforming each clause into a separate `"include"` command.
[^to_cnf]:
Automate the conversion with the function [`to_cnf()`](https://github.com/sympy/sympy/blob/58e1e9abade7c38c66871fd06bf76ebac8c1df78/sympy/logic/boolalg.py#L1691-L1730) of [SymPy](https://www.sympy.org/en/index.html).
For instance, consider the two taxa `"flow/conditional"` and `"flow/loop"`. To keep only the programs that feature either a conditional (denoted by the literal \(a\)) or a loop (denoted by the literal \(b\)), but not both of them, express first the formula in CNF: \((a \lor b) \land (\neg a \lor \neg b)\), then translate it into:
*[CNF]: Conjunctive Normal Form
wzxhzdk:36
For two taxa, there are a total of 16 combinations, listed and tested [here](https://github.com/laowantong/paroxython/blob/master/tests/test_recommend_programs.py#L665-L694).
<!---
The previous link is automatically updated by build_pdoc.py.
-->
<p>However, on a set on <strong>interdependent programs</strong>, <code>"exclude"</code> is not the opposite of <code>"include"</code> anymore: <a href="#exclude-command">as already explained</a>, excluding a program excludes also the programs which import it. Consequently, <em>including</em> the programs that do not feature a given taxon will filter out those which feature it <em>directly</em>; but <em>excluding</em> the programs that do feature this taxon will filter out those which feature it either directly or <em>indirectly</em> (by importation).</p>
<h4 id="general-semantics-of-the-negation">General semantics of the negation</h4>
<p>The semantic triple:</p>
<pre><code class="python">(taxon_pattern_1, not predicate, taxon_pattern_2)
</code></pre>
<p>&hellip; describe the set of programs which feature at least one taxon matching <code>taxon_pattern_1</code>, and such that, for any
span <code>s_1</code> of such a taxon, there exists no span <code>s_2</code> of a taxon matching <code>taxon_pattern_2</code> for which <code>predicate(s_1, s_2)</code> is verified.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that the result includes also all programs featuring at least one taxon matching <code>taxon_pattern_1</code>, but no taxon matching <code>taxon_pattern_2</code>. For instance, suppose the original (negative) triple is:</p>
<p><code>("subroutine", "not contains", "variable/assignment")</code></p>
<p>The function will return the (disjoint) union of these two sets:</p>
<ol>
<li>The programs featuring at least one subroutine, but no assignment at all.</li>
<li>The programs featuring at least one subroutine, at least one assignment, but no assignment inside a subroutine.</li>
</ol>
</div>
<p>For example, if the original (negative) predicate is <code>"taxon_pattern_1 not inside taxon_pattern_2"</code>, any program consisting in:</p>
<ul>
<li><code>"taxon_2{taxon_1}"</code><sup id="fnref:braces"><a class="footnote-ref" href="#fn:braces" rel="footnote">4</a></sup> is rejected;</li>
<li><code>"taxon_1"</code> is <strong>accepted</strong> (although there is no <code>taxon_2</code>);</li>
<li><code>"taxon_2"</code> is <strong>rejected</strong> (no <code>taxon_1</code>);</li>
<li><code>"taxon_1{taxon_2}"</code> is accepted;</li>
<li><code>"taxon_1 taxon_2{taxon_1}"</code> is accepted (there exists a couple (<code>s_1</code>, <code>s_2</code>) such that <code>taxon_1</code> is not inside <code>taxon_2</code>);</li>
<li><code>"taxon_1 taxon_2{taxon_1} taxon_2{}"</code> is accepted.</li>
</ul>
<p>If the predicate is <code>"taxon_pattern_2 not contains taxon_pattern_1"</code> (sic), any program consisting in:</p>
<ul>
<li><code>"taxon_2{taxon_1}"</code> is rejected;</li>
<li><code>"taxon_1"</code> is <strong>rejected</strong> (no <code>taxon_2</code>);</li>
<li><code>"taxon_2"</code> is <strong>accepted</strong> (although there is no <code>taxon_1</code>);</li>
<li><code>"taxon_1{taxon_2}"</code> is accepted;</li>
<li><code>"taxon_1 taxon_2{taxon_1}"</code> is accepted (there exists a couple (<code>s_1</code>, <code>s_2</code>) such that <code>taxon_2</code> does not contain <code>taxon_1</code>);</li>
<li><code>"taxon_1 taxon_2{taxon_1} taxon_2{}"</code> is accepted.</li>
</ul>
<p>Note that, due to the rule explained in the warning above, <code>"taxon_pattern_1 not inside taxon_pattern_2"</code> is not equivalent to <code>"taxon_pattern_2 not contains taxon_pattern_1"</code> (differences in <strong>bold</strong>). However, if <code>taxon_pattern_2</code> is <code>"metadata/program"</code>, which is featured by all programs, these two forms become equivalent again.</p>
<h4 id="a-practical-example">A practical example</h4>
<p>Suppose you want your course on the assignment statements to include the concept of parallel assignment, for example to introduce swapping without an auxiliary variable:</p>
<pre><code class="python">(a, b) = (b, a)
</code></pre>
<p>In the taxonomy, this concept is listed as a special case of both tuple (<code>"type/sequence/tuple"</code>) and variable assignment (<code>"variable/assignment/parallel"</code>).</p>
<p>However, you want to introduce officially the abstract data type “tuple” only much later in your course. You therefore wish to exclude from the recommendations any program implementing a tuple, unless it is part of a parallel assignment. The following command will make the trick:</p>
<pre><code class="python">  {
    &quot;operation&quot;: &quot;exclude&quot;,
    &quot;data&quot;: [
      (&quot;type/sequence/tuple&quot;, &quot;is not&quot;, &quot;variable/assignment/parallel&quot;)
    ]
  },
</code></pre>
<p>The triple describes the set of programs which feature at least one tuple, and such that there is no tuple's span coinciding with a parallel assignment's span. In other words, the set of programs which feature at least one “non parallel” tuple. When we exclude these programs, those which remain either feature no tuple, or only the ones involved in a parallel assignment.</p>
<p>The other combinations are listed and tested <a href="https://github.com/laowantong/paroxython/blob/master/tests/test_recommend_programs.py#L781-L810">here</a>.
<!---
The previous link is automatically updated by build_pdoc.py.
--></p>
<div class="footnote">
<hr>
<ol>
<li id="fn:taxon">
<p>This contrasts with the convention in biological classification, where the term <a href="https://en.wikipedia.org/wiki/Taxon">taxon</a> refers to a taxonomic <strong>unit</strong> (a node of the tree). For instance, <a href="https://en.wikipedia.org/wiki/African_elephant">African Elephant </a> is classified under the taxon <em>Loxodonta</em>. However, a taxon (implicitely) “encompasses all included taxa of lower rank”, here:</p>
<ul>
<li>Kingdom:
<em>Animalia</em></li>
<li>Phylum:
<em>Chordata</em></li>
<li>Class:
<em>Mammalia</em></li>
<li>Order:
<em>Proboscidea</em></li>
<li>Family:
<em>Elephantidae</em></li>
<li>Subfamily:
<em>Elephantinae</em></li>
<li>Genus:
<em>Loxodonta</em></li>
</ul>
<p>Since our nodes are not uniquely named (e.g., there are several nodes <code>literal</code>), we make all the lower rank nodes explicit by concatenating them (i.e., <code>type/number/integer/literal</code> instead of simply <code>literal</code>, which would be ambiguous)🐘.&#160;<a class="footnote-backref" href="#fnref:taxon" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:tree_sql">
<p>More precisely, it is the result of
<code>SELECT taxon, count(*)
FROM taxon
WHERE taxon LIKE 'type/%'
GROUP BY taxon</code>
on the SQLite tag database.&#160;<a class="footnote-backref" href="#fnref:tree_sql" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:compare">
<p>On a side note: in the <abbr title="Abstract Syntax Tree">AST</abbr>, an expression like <code>a &lt; b &lt; c</code> counts for <strong>one</strong> (chained) comparison.&#160;<a class="footnote-backref" href="#fnref:compare" rev="footnote" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:braces">
<p>In these examples, the braces denote the fact that the span of a certain taxon is included in that of another taxon.&#160;<a class="footnote-backref" href="#fnref:braces" rev="footnote" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
</ol>
</div>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<header>
<a class="homelink" rel="home" title="Paroxython Home" href="../index.html">
<img src="https://laowantong.github.io/paroxython/resources/logo.png" alt="Paroxython logo">
</a>
</header>
<h1>User manual</h1>
<div class="toc">
<ul>
<li><a href="#pipeline-tutorial-getting-recommendations">Pipeline tutorial: getting recommendations</a><ul>
<li><a href="#covering-your-bases">Covering your base(s)</a></li>
<li><a href="#imparting-knowledge">Imparting knowledge</a><ul>
<li><a href="#tracking-the-progress-of-your-course">Tracking the progress of your course</a></li>
<li><a href="#coming-after-another-course">Coming after another course</a></li>
</ul>
</li>
<li><a href="#blacklisting-programs">Blacklisting programs</a></li>
<li><a href="#concepts-to-be-introduced-later-or-never">Concepts to be introduced later (or never)</a></li>
<li><a href="#concepts-to-be-introduced-now">Concepts to be introduced now</a></li>
<li><a href="#preparing-an-assignment">Preparing an assignment</a></li>
</ul>
</li>
<li><a href="#tag-databases">Tag databases</a><ul>
<li><a href="#the-json-tag-database">The JSON tag database</a></li>
<li><a href="#the-sqlite-tag-database">The SQLite tag database</a></li>
</ul>
</li>
<li><a href="#taxonomy">Taxonomy</a><ul>
<li><a href="#structure">Structure</a></li>
<li><a href="#mapping-the-labels-onto-taxa">Mapping the labels onto taxa</a><ul>
<li><a href="#1-1-and-n-1-mappings">1-1 and N-1 mappings</a></li>
<li><a href="#1-0-mapping">1-0 mapping</a></li>
<li><a href="#1-n-mapping">1-N mapping</a><ul>
<li><a href="#general-semantics-of-the-negation">General semantics of the negation</a></li>
<li><a href="#a-practical-example">A practical example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.4</a>.</p>
</footer>
</body>
</html>